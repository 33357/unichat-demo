(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d7f44ab"],{"0188":function(t,a,s){},"0fbc":function(t,a,s){"use strict";s("0188")},"14cc":function(t,a,s){},2932:function(t,a,s){"use strict";s("f33d")},"32a0":function(t,a,s){},"58fa":function(t,a,s){"use strict";s("85a7")},"5c4c":function(t,a,s){"use strict";s("8ef9")},"821a":function(t,a,s){"use strict";s("be7f")},8325:function(t,a,s){"use strict";s("14cc")},"85a7":function(t,a,s){},"8ef9":function(t,a,s){},"9e34":function(t,a,s){},"9f78":function(t,a,s){"use strict";s.r(a);var e=function(){var t=this,a=t._self._c;t._self._setupProxy;return a("div",{staticClass:"chat",style:{"--bg-image":`url('${t.appStorage.background}')`}},[t.visibleTool?a("div",{staticClass:"chat-part1"},[a("my-tool")],1):t._e(),a("div",{staticClass:"chat-part2"},[a("my-search"),a("my-room")],1),a("div",{staticClass:"chat-part3"},[a("a-icon",{staticClass:"chat-team",attrs:{type:"message"},on:{click:t.toggleDrawer}}),a("div",{staticClass:"chat-tool"},[t.visibleTool?a("a-icon",{attrs:{type:"menu-fold"},on:{click:t.toggleTool}}):a("a-icon",{attrs:{type:"menu-unfold"},on:{click:t.toggleTool}})],1),a("my-message")],1),a("a-drawer",{staticStyle:{height:"100%"},attrs:{placement:"left",closable:!1,visible:t.visibleDrawer},on:{close:t.toggleDrawer}},[a("div",{staticClass:"chat-drawer"},[a("my-search"),a("my-room")],1)])],1)},c=[],o=s("ade3"),n=s("9ab4"),i=s("60a3"),r=function(){var t=this,a=t._self._c;t._self._setupProxy;return a("div",{staticClass:"tool"},[a("div",{staticClass:"tool-avatar"},[a("div",{staticClass:"tool-avatar-img",on:{click:function(a){t.showUserModal=!0}}},[t.appSync.avatarMap[t.appSync.userAddress]?a("img",{attrs:{src:t.appSync.avatarMap[t.appSync.userAddress],alt:""}}):t._e()]),a("div",{staticClass:"tool-avatar-name"},[t._v(t._s(t.appSync.userAddress))])]),a("myIcon",{staticClass:"icon tool-language",attrs:{type:"language"},on:{click:function(a){"cn"==t.$i18n.locale?t.$i18n.locale="en":t.$i18n.locale="cn"}}}),a("a-icon",{staticClass:"tool-skin icon",attrs:{type:"skin"},on:{click:function(a){t.showBackgroundModal=!0}}}),a("a",{staticClass:"tool-home icon",attrs:{href:"https://unichat.space",target:"_blank"}},[a("a-icon",{attrs:{type:"home"}})],1),a("a-modal",{attrs:{title:t.$t("tool.user_info"),visible:t.showUserModal,footer:""},on:{cancel:function(a){t.showUserModal=!1}}},[a("div",{staticClass:"tool-user"},[t.appSync.avatarMap[t.appSync.userAddress]?a("div",{staticClass:"tool-user-avatar"},[a("a-avatar",{staticClass:"img",attrs:{src:t.appSync.avatarMap[t.appSync.userAddress],size:120}})],1):t._e(),a("div",{staticClass:"tool-user-info"},[a("div",{staticClass:"tool-user-title"},[t._v(t._s(t.$t("tool.user_address")))]),a("div",{staticClass:"tool-user-input"},[t._v(t._s(t.appSync.userAddress))])])])]),a("a-modal",{attrs:{title:t.$t("tool.theme"),visible:t.showBackgroundModal,footer:""},on:{cancel:function(a){t.showBackgroundModal=!1}}},[a("div",{staticClass:"tool-user-info"},[a("div",{staticClass:"tool-user-title",staticStyle:{width:"65px"}},[a("span",[t._v(t._s(t.$t("tool.background_image")))]),a("a-tooltip",{attrs:{placement:"topLeft","arrow-point-at-center":""}},[a("div",{attrs:{slot:"title"},slot:"title"},[a("span",[t._v(t._s(t.$t("tool.support_jpg_png_gif_and_other_formats")))])]),a("a-icon",{staticStyle:{"margin-left":"5px"},attrs:{type:"exclamation-circle"}})],1)],1),a("a-input",{staticClass:"tool-user-input",attrs:{placeholder:t.$t("tool.please_enter_the_background_image_url")},model:{value:t.backgroundInput,callback:function(a){t.backgroundInput=a},expression:"backgroundInput"}}),a("a-button",{attrs:{type:"primary"},on:{click:function(a){return t.changeBackground(t.backgroundInput)}}},[t._v(t._s(t.$t("tool.confirm")))])],1),a("div",{staticClass:"tool-recommend"},t._l(t.BACKGROUND_LIST,(function(s,e){return a("div",{key:e,staticClass:"recommend",on:{click:function(a){return t.changeBackground(s.URL)}}},[a("img",{attrs:{src:s.URL,alt:""}}),a("span",{staticClass:"text"},[t._v(t._s(s.TEXT))])])})),0)])],1)},l=[],d=s("4bb5"),p=s("3fff");const u=Object(d["a"])("app");let v=class extends i["c"]{constructor(...t){super(...t),Object(o["a"])(this,"appStorage",void 0),Object(o["a"])(this,"appSync",void 0),Object(o["a"])(this,"showUserModal",!1),Object(o["a"])(this,"showBackgroundModal",!1),Object(o["a"])(this,"showShovelModal",!1),Object(o["a"])(this,"showCrowdFundingModal",!1),Object(o["a"])(this,"backgroundInput",""),Object(o["a"])(this,"BACKGROUND_LIST",p["a"])}changeBackground(t){t.trim().length&&(this.appStorage.background=t),this.showBackgroundModal=!1}};Object(n["a"])([u.State("storage")],v.prototype,"appStorage",void 0),Object(n["a"])([u.State("sync")],v.prototype,"appSync",void 0),v=Object(n["a"])([Object(i["a"])({})],v);var h=v,m=h,f=(s("5c4c"),s("2877")),y=Object(f["a"])(m,r,l,!1,null,"3acbd2a4",null),j=y.exports,b=function(){var t=this,a=t._self._c;t._self._setupProxy;return a("div",{staticClass:"room"},t._l(t.chatSync.toList,(function(s,e){return a("div",{key:e},[a("div",{staticClass:"room-card",class:{active:t.chatSync.activeTo==s},on:{click:function(a){return t.setActiveTo(s)}}},[a("a-badge",{staticClass:"room-card-badge"}),a("my-avatar",{attrs:{avatar:t.getRoomLogo(s),showName:t.utils.format.string2(s,6)},on:{goTo:function(a){return t.utils.go.token(t.appSync.ether.chainId?t.appSync.ether.chainId:0,s)}}}),a("div",{staticClass:"room-card-message"},[a("div",{staticClass:"room-card-name"},[a("div",[t._v(" "+t._s(t.getRoomName(s))+" "),t.chatSync.toList.length>1?a("a-icon",{staticClass:"room-card-close",attrs:{type:"close-circle-o"},on:{click:function(a){return a.stopPropagation(),t.closeTo(s)}}}):t._e()],1),a("div",{staticClass:"room-card-new"},[t._v(" "+t._s(t.getRoomLastMessage(s))+" ")])])])],1)])})),0)},g=[],_=function(){var t=this,a=t._self._c;t._self._setupProxy;return a("div",{staticClass:"avatar"},[a("a-popover",[a("div",{staticClass:"avatar-card",attrs:{slot:"content"},slot:"content"},[a("a-avatar",{attrs:{size:60,src:t.avatar}}),a("div",[t._v(t._s(t.showName))]),t.showButton?a("a-button",{attrs:{type:"primary",disabled:t.disabled},on:{click:function(a){return t.$emit("goTo")}}},[t._v(t._s(t.$t("avatar.view_on_the_blockchain_browser")))]):t._e()],1),a("a-avatar",{staticClass:"avatar-img",attrs:{src:t.avatar}})],1),a("div",[a("span",{staticClass:"avatar-name"},[t._v(t._s(t.name))]),a("span",{staticClass:"avatar-time"},[t._v(t._s(t.time))])])],1)},k=[];let O=class extends i["c"]{constructor(...t){super(...t),Object(o["a"])(this,"avatar",void 0),Object(o["a"])(this,"name",void 0),Object(o["a"])(this,"time",void 0),Object(o["a"])(this,"showName",void 0),Object(o["a"])(this,"disabled",void 0),Object(o["a"])(this,"showButton",void 0)}};Object(n["a"])([Object(i["b"])()],O.prototype,"avatar",void 0),Object(n["a"])([Object(i["b"])()],O.prototype,"name",void 0),Object(n["a"])([Object(i["b"])()],O.prototype,"time",void 0),Object(n["a"])([Object(i["b"])()],O.prototype,"showName",void 0),Object(n["a"])([Object(i["b"])({default:!1})],O.prototype,"disabled",void 0),Object(n["a"])([Object(i["b"])({default:!0})],O.prototype,"showButton",void 0),O=Object(n["a"])([i["a"]],O);var S=O,E=S,C=(s("0fbc"),Object(f["a"])(E,_,k,!1,null,"0e0f6e95",null)),w=C.exports;const A=Object(d["a"])("chat"),M=Object(d["a"])("app");let T=class extends i["c"]{constructor(...t){super(...t),Object(o["a"])(this,"appSync",void 0),Object(o["a"])(this,"appAsync",void 0),Object(o["a"])(this,"chatSync",void 0),Object(o["a"])(this,"chatAsync",void 0),Object(o["a"])(this,"utils",p["f"])}getRoomLogo(t){try{if(this.appAsync.tokenMap[t].logo)return this.appAsync.tokenMap[t].logo;throw""}catch(a){return"./static/token/empty-token.png"}}getRoomName(t){let a=p["f"].format.string2(t,6);try{a=this.appAsync.tokenMap[t].name}catch(e){}let s="";try{s=`(${p["f"].format.balance(this.appAsync.balanceMap[t][this.appSync.userAddress],18,this.appAsync.tokenMap[t].symbol,this.appSync.decimalLimit)})`}catch(e){}return a+s}getRoomLastMessage(t){try{const a=p["f"].get.last(this.chatAsync.messageMap[t].messageList);return`[${p["f"].format.string2(a.from,4)}]${p["f"].format.string1(a.data,7)}`}catch(a){return""}}async closeTo(t){await this.$store.dispatch("chat/deleteTo",t)}async setActiveTo(t){await this.$store.dispatch("chat/setActiveTo",t)}};Object(n["a"])([M.State("sync")],T.prototype,"appSync",void 0),Object(n["a"])([M.State("async")],T.prototype,"appAsync",void 0),Object(n["a"])([A.State("sync")],T.prototype,"chatSync",void 0),Object(n["a"])([A.State("async")],T.prototype,"chatAsync",void 0),T=Object(n["a"])([Object(i["a"])({components:{MyAvatar:w}})],T);var x=T,$=x,D=(s("8325"),Object(f["a"])($,b,g,!1,null,"03c3b3f4",null)),L=D.exports,R=function(){var t=this,a=t._self._c;t._self._setupProxy;return a("div",{staticClass:"message"},[a("div",{staticClass:"message-header"},[a("div",{staticClass:"message-header-box"},[a("span",{staticClass:"message-header-text"},[t._v(" "+t._s(t.getRoomName())+" ")])])]),a("transition",{attrs:{name:"loading"}},[t.get_loading()?a("div",{staticClass:"message-loading"},[a("a-icon",{staticClass:"message-loading-icon",attrs:{type:"sync",spin:""}})],1):t._e()]),a("div",{staticClass:"message-main",style:{opacity:t.messageOpacity}},[t.chatAsync.messageMap[t.chatSync.activeTo]?a("div",{staticClass:"message-content"},[t._l(t.chatAsync.messageMap[t.chatSync.activeTo].messageList,(function(s,e){return[a("div",{key:e,staticClass:"message-content-message",class:{"text-right":s.from==t.appSync.userAddress}},[a("my-avatar",{attrs:{avatar:t.appSync.avatarMap[s.from],name:t.getFromName(s.from),time:t.utils.format.date(s.date),showName:t.utils.format.string2(s.from,6)},on:{goTo:function(a){return t.utils.go.address(t.appSync.ether.chainId?t.appSync.ether.chainId:0,s.from)}}}),a("div",{staticClass:"message-content-text"},["text"==t.getDataType(s.data)?a("div",[t._v(t._s(s.data))]):t._e()])],1)]}))],2):t._e()]),a("my-input")],1)},B=[],I=function(){var t=this,a=t._self._c;t._self._setupProxy;return a("div",{staticClass:"message-input"},[a("a-popover",{staticClass:"message-popver",attrs:{placement:"topLeft",trigger:"hover"}},[a("template",{slot:"content"},[a("a-tabs",{attrs:{"default-key":"1",size:"small"}},[a("a-tab-pane",{key:"1",attrs:{tab:"Emoji"}},[a("my-emoji",{on:{addEmoji:t.addEmoji}})],1)],1)],1),a("div",{staticClass:"messagte-tool-icon"},[t._v("😃")])],2),a("a-input",{ref:"data",staticStyle:{color:"#000"},attrs:{autocomplete:"off",type:"text",placeholder:t.$t("input.hello")+"...",autoFocus:""},on:{pressEnter:t.sendMessage},model:{value:t.data,callback:function(a){t.data=a},expression:"data"}}),a("myIcon",{class:t.get_send(),attrs:{type:"send"},on:{click:t.sendMessage}})],1)},N=[],P=(s("d9e2"),function(){var t=this,a=t._self._c;t._self._setupProxy;return a("div",{staticClass:"emoji-content"},[a("div",{staticClass:"emoji-content-item"},[a("span",{on:{click:function(a){return t.addEmoji("😃")}}},[t._v("😃")]),a("span",{on:{click:function(a){return t.addEmoji("😁")}}},[t._v("😁")]),a("span",{on:{click:function(a){return t.addEmoji("😂")}}},[t._v("😂")]),a("span",{on:{click:function(a){return t.addEmoji("😄")}}},[t._v("😄")]),a("span",{on:{click:function(a){return t.addEmoji("😅")}}},[t._v("😅")]),a("span",{on:{click:function(a){return t.addEmoji("😆")}}},[t._v("😆")]),a("span",{on:{click:function(a){return t.addEmoji("😇")}}},[t._v("😇")]),a("span",{on:{click:function(a){return t.addEmoji("😈")}}},[t._v("😈")]),a("span",{on:{click:function(a){return t.addEmoji("😉")}}},[t._v("😉")])]),a("div",{staticClass:"emoji-content-item"},[a("span",{on:{click:function(a){return t.addEmoji("😊")}}},[t._v("😊")]),a("span",{on:{click:function(a){return t.addEmoji("😋")}}},[t._v("😋")]),a("span",{on:{click:function(a){return t.addEmoji("😌")}}},[t._v("😌")]),a("span",{on:{click:function(a){return t.addEmoji("😍")}}},[t._v("😍")]),a("span",{on:{click:function(a){return t.addEmoji("😎")}}},[t._v("😎")]),a("span",{on:{click:function(a){return t.addEmoji("😏")}}},[t._v("😏")]),a("span",{on:{click:function(a){return t.addEmoji("😐")}}},[t._v("😐")]),a("span",{on:{click:function(a){return t.addEmoji("😒")}}},[t._v("😒")]),a("span",{on:{click:function(a){return t.addEmoji("😓")}}},[t._v("😓")])]),a("div",{staticClass:"emoji-content-item"},[a("span",{on:{click:function(a){return t.addEmoji("❓")}}},[t._v("❓")]),a("span",{on:{click:function(a){return t.addEmoji("😕")}}},[t._v("😕")]),a("span",{on:{click:function(a){return t.addEmoji("😖")}}},[t._v("😖")]),a("span",{on:{click:function(a){return t.addEmoji("😗")}}},[t._v("😗")]),a("span",{on:{click:function(a){return t.addEmoji("😘")}}},[t._v("😘")]),a("span",{on:{click:function(a){return t.addEmoji("😙")}}},[t._v("😙")]),a("span",{on:{click:function(a){return t.addEmoji("😚")}}},[t._v("😚")]),a("span",{on:{click:function(a){return t.addEmoji("😜")}}},[t._v("😜")]),a("span",{on:{click:function(a){return t.addEmoji("😝")}}},[t._v("😝")])]),a("div",{staticClass:"emoji-content-item"},[a("span",{on:{click:function(a){return t.addEmoji("😞")}}},[t._v("😞")]),a("span",{on:{click:function(a){return t.addEmoji("😟")}}},[t._v("😟")]),a("span",{on:{click:function(a){return t.addEmoji("😠")}}},[t._v("😠")]),a("span",{on:{click:function(a){return t.addEmoji("😡")}}},[t._v("😡")]),a("span",{on:{click:function(a){return t.addEmoji("😢")}}},[t._v("😢")]),a("span",{on:{click:function(a){return t.addEmoji("😣")}}},[t._v("😣")]),a("span",{on:{click:function(a){return t.addEmoji("😤")}}},[t._v("😤")]),a("span",{on:{click:function(a){return t.addEmoji("😥")}}},[t._v("😥")]),a("span",{on:{click:function(a){return t.addEmoji("😦")}}},[t._v("😦")])]),a("div",{staticClass:"emoji-content-item"},[a("span",{on:{click:function(a){return t.addEmoji("😨")}}},[t._v("😨")]),a("span",{on:{click:function(a){return t.addEmoji("😩")}}},[t._v("😩")]),a("span",{on:{click:function(a){return t.addEmoji("😪")}}},[t._v("😪")]),a("span",{on:{click:function(a){return t.addEmoji("😫")}}},[t._v("😫")]),a("span",{on:{click:function(a){return t.addEmoji("😬")}}},[t._v("😬")]),a("span",{on:{click:function(a){return t.addEmoji("😭")}}},[t._v("😭")]),a("span",{on:{click:function(a){return t.addEmoji("😮")}}},[t._v("😮")]),a("span",{on:{click:function(a){return t.addEmoji("😯")}}},[t._v("😯")]),a("span",{on:{click:function(a){return t.addEmoji("😰")}}},[t._v("😰")])]),a("div",{staticClass:"emoji-content-item"},[a("span",{on:{click:function(a){return t.addEmoji("😲")}}},[t._v("😲")]),a("span",{on:{click:function(a){return t.addEmoji("😳")}}},[t._v("😳")]),a("span",{on:{click:function(a){return t.addEmoji("😴")}}},[t._v("😴")]),a("span",{on:{click:function(a){return t.addEmoji("😵")}}},[t._v("😵")]),a("span",{on:{click:function(a){return t.addEmoji("🧐")}}},[t._v("🧐")]),a("span",{on:{click:function(a){return t.addEmoji("😷")}}},[t._v("😷")]),a("span",{on:{click:function(a){return t.addEmoji("🙁")}}},[t._v("🙁")]),a("span",{on:{click:function(a){return t.addEmoji("🙂")}}},[t._v("🙂")]),a("span",{on:{click:function(a){return t.addEmoji("🙃")}}},[t._v("🙃")])]),a("div",{staticClass:"emoji-content-item"},[a("span",{on:{click:function(a){return t.addEmoji("🤐")}}},[t._v("🤐")]),a("span",{on:{click:function(a){return t.addEmoji("🤑")}}},[t._v("🤑")]),a("span",{on:{click:function(a){return t.addEmoji("🤒")}}},[t._v("🤒")]),a("span",{on:{click:function(a){return t.addEmoji("🤓")}}},[t._v("🤓")]),a("span",{on:{click:function(a){return t.addEmoji("🤔")}}},[t._v("🤔")]),a("span",{on:{click:function(a){return t.addEmoji("🤕")}}},[t._v("🤕")]),a("span",{on:{click:function(a){return t.addEmoji("🤠")}}},[t._v("🤠")]),a("span",{on:{click:function(a){return t.addEmoji("🤡")}}},[t._v("🤡")]),a("span",{on:{click:function(a){return t.addEmoji("🤢")}}},[t._v("🤢")])]),a("div",{staticClass:"emoji-content-item"},[a("span",{on:{click:function(a){return t.addEmoji("🤤")}}},[t._v("🤤")]),a("span",{on:{click:function(a){return t.addEmoji("🤥")}}},[t._v("🤥")]),a("span",{on:{click:function(a){return t.addEmoji("🤧")}}},[t._v("🤧")]),a("span",{on:{click:function(a){return t.addEmoji("🤨")}}},[t._v("🤨")]),a("span",{on:{click:function(a){return t.addEmoji("🤩")}}},[t._v("🤩")]),a("span",{on:{click:function(a){return t.addEmoji("🤪")}}},[t._v("🤪")]),a("span",{on:{click:function(a){return t.addEmoji("🤫")}}},[t._v("🤫")]),a("span",{on:{click:function(a){return t.addEmoji("🤬")}}},[t._v("🤬")]),a("span",{on:{click:function(a){return t.addEmoji("🤭")}}},[t._v("🤭")])])])}),U=[];let F=class extends i["c"]{addEmoji(t){this.$emit("addEmoji",t)}};F=Object(n["a"])([i["a"]],F);var z=F,q=z,G=(s("c42c"),Object(f["a"])(q,P,U,!1,null,"0bf690e2",null)),H=G.exports;const J=Object(d["a"])("chat"),K=Object(d["a"])("app");let X=class extends i["c"]{constructor(...t){super(...t),Object(o["a"])(this,"appStorage",void 0),Object(o["a"])(this,"appSync",void 0),Object(o["a"])(this,"appAsync",void 0),Object(o["a"])(this,"chatSync",void 0),Object(o["a"])(this,"chatAsync",void 0),Object(o["a"])(this,"data","")}get_send(){return"message-input-button1"}async sendMessage(){try{if(!this.data.trim())throw new Error(this.$t("input.cannot_send_empty_messages"));const t=this.data;this.data="",await this.$store.dispatch("chat/sendMessage",t)}catch(t){Object(p["d"])(t),this.$message.error(t.message)}}addEmoji(t){const a=this.$refs.data.$el;if(a.selectionStart||"0"===a.selectionStart){const s=a.selectionStart,e=a.selectionEnd,c=a.scrollTop;this.data=this.data.substring(0,s)+t+this.data.substring(e,this.data.length),c>0&&(a.scrollTop=c),a.focus();const o=s+t.length;if(a.setSelectionRange)a.focus(),setTimeout(()=>{a.setSelectionRange(o,o)},10);else if(a.createTextRange){const t=a.createTextRange();t.collapse(!0),t.moveEnd("character",o),t.moveStart("character",o),t.select()}}else this.data+=t,a.focus()}};Object(n["a"])([K.State("storage")],X.prototype,"appStorage",void 0),Object(n["a"])([K.State("sync")],X.prototype,"appSync",void 0),Object(n["a"])([K.State("async")],X.prototype,"appAsync",void 0),Object(n["a"])([J.State("sync")],X.prototype,"chatSync",void 0),Object(n["a"])([J.State("async")],X.prototype,"chatAsync",void 0),X=Object(n["a"])([Object(i["a"])({components:{MyEmoji:H}})],X);var Q=X,V=Q,W=(s("2932"),Object(f["a"])(V,I,N,!1,null,"601602c1",null)),Y=W.exports;const Z=Object(d["a"])("chat"),tt=Object(d["a"])("app");let at=class extends i["c"]{constructor(...t){super(...t),Object(o["a"])(this,"appSync",void 0),Object(o["a"])(this,"appAsync",void 0),Object(o["a"])(this,"chatSync",void 0),Object(o["a"])(this,"chatAsync",void 0),Object(o["a"])(this,"utils",p["f"]),Object(o["a"])(this,"messageDom",void 0),Object(o["a"])(this,"messageContentDom",void 0),Object(o["a"])(this,"headerDom",void 0),Object(o["a"])(this,"messageOpacity",1),Object(o["a"])(this,"lastMessagePosition",0)}getRoomName(){let t=this.chatSync.activeTo;try{t=this.appAsync.tokenMap[this.chatSync.activeTo].name}catch(s){}let a="";try{a=`(${this.chatAsync.messageMap[this.chatSync.activeTo].length} messages)`}catch(s){}return t+a}getFromName(t){if(t==this.appSync.userAddress)return"";{let s=p["f"].format.string2(t,6);try{s=p["f"].format.balance(this.appAsync.balanceMap[this.chatSync.activeTo][t],18,this.appAsync.tokenMap[this.chatSync.activeTo].symbol,this.appSync.decimalLimit)}catch(a){}return s}}getDataType(t){return"text"}get_loading(){return!1}scrollToBottom(){this.$nextTick(()=>{this.messageDom.scrollTop=this.messageDom.scrollHeight,this.messageOpacity=1})}scrollTo(){this.$nextTick(()=>{this.messageDom.scrollTop=this.messageContentDom.offsetHeight-this.lastMessagePosition})}};Object(n["a"])([tt.State("sync")],at.prototype,"appSync",void 0),Object(n["a"])([tt.State("async")],at.prototype,"appAsync",void 0),Object(n["a"])([Z.State("sync")],at.prototype,"chatSync",void 0),Object(n["a"])([Z.State("async")],at.prototype,"chatAsync",void 0),at=Object(n["a"])([Object(i["a"])({components:{MyAvatar:w,MyInput:Y}})],at);var st=at,et=st,ct=(s("58fa"),Object(f["a"])(et,R,B,!1,null,"26058ae2",null)),ot=ct.exports,nt=function(){var t=this,a=t._self._c;t._self._setupProxy;return a("div",{staticClass:"search"},[a("div",{staticClass:"search-select"},[a("a-select",{attrs:{"show-search":"",placeholder:t.$t("search.search"),"default-active-first-option":!1,"show-arrow":!1,"filter-option":!1,"not-found-content":null},on:{search:t.handleSearch}},[t.searchData.to?a("a-select-option",{attrs:{value:t.searchData.to}},[a("div",{on:{click:function(a){return t.selectChat(t.searchData.to)}}},[a("div",{staticClass:"avatar"},[a("my-avatar",{attrs:{avatar:t.getRoomLogo(),showButton:!1,showName:t.searchData.to}}),a("span",{staticClass:"avatar-name"},[t._v(t._s(t.searchData.text))])],1)])]):t._e()],1)],1)])},it=[];const rt=Object(d["a"])("chat"),lt=Object(d["a"])("app");let dt=class extends i["c"]{constructor(...t){super(...t),Object(o["a"])(this,"appStorage",void 0),Object(o["a"])(this,"appSync",void 0),Object(o["a"])(this,"appAsync",void 0),Object(o["a"])(this,"chatSync",void 0),Object(o["a"])(this,"searchData",{})}getRoomLogo(){try{if(this.appAsync.tokenMap[this.searchData.to.toString()].logo)return this.appAsync.tokenMap[this.searchData.to.toString()].logo;throw""}catch(t){return"./static/token/empty-token.png"}}async handleSearch(t){if(p["f"].ethers.isAddress(t)){t=p["f"].ethers.getAddress(t);const{length:a}=await this.appSync.api.getMessage(this.appSync.ether.chainId.toString(),t,0,0);await this.$store.dispatch("app/getTokenData",[t]),await this.$store.dispatch("app/getTokenBalance",{contract:t,addressList:[this.appSync.userAddress]}),this.searchData={to:t,text:`${p["f"].format.balance(this.appAsync.balanceMap[t][this.appSync.userAddress],18,this.appAsync.tokenMap[t].symbol,this.appSync.decimalLimit)}(${a} messages)`}}}async selectChat(t){this.searchData={},await this.$store.dispatch("chat/setActiveTo",t)}};Object(n["a"])([lt.State("storage")],dt.prototype,"appStorage",void 0),Object(n["a"])([lt.State("sync")],dt.prototype,"appSync",void 0),Object(n["a"])([lt.State("async")],dt.prototype,"appAsync",void 0),Object(n["a"])([rt.State("sync")],dt.prototype,"chatSync",void 0),dt=Object(n["a"])([Object(i["a"])({components:{MyAvatar:w}})],dt);var pt=dt,ut=pt,vt=(s("821a"),Object(f["a"])(ut,nt,it,!1,null,"72892f61",null)),ht=vt.exports;const mt=Object(d["a"])("app");let ft=class extends i["c"]{constructor(...t){super(...t),Object(o["a"])(this,"appStorage",void 0),Object(o["a"])(this,"appSync",void 0),Object(o["a"])(this,"visibleDrawer",!1),Object(o["a"])(this,"visibleTool",!0)}created(){window.addEventListener("load",async()=>{try{Object(p["d"])("window load"),await this.$store.dispatch("app/start"),this.$route.query.r&&await this.$store.dispatch("chat/setActiveRecipient",this.$route.query.r),this.appSync.isMobile&&(this.visibleDrawer=!0,this.visibleTool=!1),await this.$store.dispatch("chat/start")}catch(t){Object(p["d"])(t),this.$message.error(t.message)}})}toggleDrawer(){this.visibleDrawer=!this.visibleDrawer}toggleTool(){this.visibleTool=!this.visibleTool}};Object(n["a"])([mt.State("storage")],ft.prototype,"appStorage",void 0),Object(n["a"])([mt.State("sync")],ft.prototype,"appSync",void 0),ft=Object(n["a"])([Object(i["a"])({components:{MyTool:j,MyRoom:L,MyMessage:ot,MySearch:ht}})],ft);var yt=ft,jt=yt,bt=(s("aab1"),Object(f["a"])(jt,e,c,!1,null,"8bd983cc",null));a["default"]=bt.exports},aab1:function(t,a,s){"use strict";s("32a0")},be7f:function(t,a,s){},c42c:function(t,a,s){"use strict";s("9e34")},f33d:function(t,a,s){}}]);